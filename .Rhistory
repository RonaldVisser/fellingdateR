names(corr_table_i) <- c("series", "reference", i)
# data.frame(
# series = rownames(corr_table_i)[row(corr_table_i)],
# reference = colnames(corr_table_i)[col(corr_table_i)],
# i = c(corr_table_i)
# )
corr_df <- corr_table_i[!duplicated(t(apply(corr_table_i[c("series", "reference")], 1, sort))), ]
} else {
corr_table_i <- corr_table[[i]]
corr_table_i <- as.data.frame(
as.table(corr_table_i)
)
names(corr_table_i) <- c("series", "reference", i)
# corr_table_i <- corr_table[[i]]
# corr_table_i <- data.frame(
#      series = rownames(corr_table_i)[row(corr_table_i)],
#      reference = colnames(corr_table_i)[col(corr_table_i)],
#      i = c(corr_table_i)
#      )
corr_table_i <- corr_table_i[!duplicated(t(apply(corr_table_i[c("series", "reference")], 1, sort))), ]
corr_df <- merge[corr_df, corr_table_i]
}
corr_table_i <- corr_table[[i]]
corr_table_i <- as.data.frame(
as.table(corr_table_i)
)
names(corr_table_i) <- c("series", "reference", i)
View(corr_table_i)
# corr_table_i <- corr_table[[i]]
# corr_table_i <- data.frame(
#      series = rownames(corr_table_i)[row(corr_table_i)],
#      reference = colnames(corr_table_i)[col(corr_table_i)],
#      i = c(corr_table_i)
#      )
corr_table_i <- corr_table_i[!duplicated(t(apply(corr_table_i[c("series", "reference")], 1, sort))), ]
i = "overlap"
if (i == names(corr_table)[1]){
corr_table_i <- corr_table[[i]]
corr_table_i <- as.data.frame(
as.table(corr_table_i)
)
names(corr_table_i) <- c("series", "reference", i)
# data.frame(
# series = rownames(corr_table_i)[row(corr_table_i)],
# reference = colnames(corr_table_i)[col(corr_table_i)],
# i = c(corr_table_i)
# )
# corr_df <- corr_table_i[!duplicated(t(apply(corr_table_i[c("series", "reference")], 1, sort))), ]
}
i = "glk"
corr_table_i <- corr_table[[i]]
corr_table_i <- as.data.frame(
as.table(corr_table_i)
)
names(corr_table_i) <- c("series", "reference", i)
# corr_table_i <- corr_table[[i]]
# corr_table_i <- data.frame(
#      series = rownames(corr_table_i)[row(corr_table_i)],
#      reference = colnames(corr_table_i)[col(corr_table_i)],
#      i = c(corr_table_i)
#      )
# corr_table_i <- corr_table_i[!duplicated(t(apply(corr_table_i[c("series", "reference")], 1, sort))), ]
corr_df <- merge[corr_df, corr_table_i]
# corr_table_i <- corr_table[[i]]
# corr_table_i <- data.frame(
#      series = rownames(corr_table_i)[row(corr_table_i)],
#      reference = colnames(corr_table_i)[col(corr_table_i)],
#      i = c(corr_table_i)
#      )
# corr_table_i <- corr_table_i[!duplicated(t(apply(corr_table_i[c("series", "reference")], 1, sort))), ]
corr_df <- merge[corr_df, corr_table_i, by = c("series", "reference")]
# corr_table_i <- corr_table[[i]]
# corr_table_i <- data.frame(
#      series = rownames(corr_table_i)[row(corr_table_i)],
#      reference = colnames(corr_table_i)[col(corr_table_i)],
#      i = c(corr_table_i)
#      )
# corr_table_i <- corr_table_i[!duplicated(t(apply(corr_table_i[c("series", "reference")], 1, sort))), ]
corr_df <- merge(corr_df, corr_table_i, by = c("series", "reference")
}
# corr_table_i <- corr_table[[i]]
# corr_table_i <- data.frame(
#      series = rownames(corr_table_i)[row(corr_table_i)],
#      reference = colnames(corr_table_i)[col(corr_table_i)],
#      i = c(corr_table_i)
#      )
# corr_table_i <- corr_table_i[!duplicated(t(apply(corr_table_i[c("series", "reference")], 1, sort))), ]
corr_df <- merge(corr_df, corr_table_i, by = c("series", "reference"))
View(corr_df)
corr_df <- corr_df[!duplicated(t(apply(corr_df[c("series", "reference")], 1, sort))), ]
source("C:/Users/hanecakr/Documents/R_github/fellingdateR/R/corr_table.R")
source("C:/Users/hanecakr/Documents/R_github/fellingdateR/R/corr_table.R")
ct0 <- CorrTable(x = trs, y = refs)
ct1 <- corr_table(x = trs, y = refs)
descr <- dplR::rwl.stats(trs)[,1:4]
colnames(descr) <- c("series", "first", "last", "length")
corr_table <- ct1m
for (i in names(corr_table)){
if (i == names(corr_table)[1]){
corr_table_i <- corr_table[[i]]
corr_table_i <- as.data.frame(
as.table(corr_table_i)
)
names(corr_table_i) <- c("series", "reference", i)
} else {
corr_table_i <- corr_table[[i]]
corr_table_i <- as.data.frame(
as.table(corr_table_i)
)
names(corr_table_i) <- c("series", "reference", i)
corr_df <- merge(corr_df, corr_table_i, by = c("series", "reference"))
}
}
corr_df <- corr_df[!duplicated(t(apply(corr_df[c("series", "reference")], 1, sort))), ]
corr_table <- ct1m
names(coor_table)
names(corr_table)
for (i in names(corr_table)){
if (i == names(corr_table)[1]){
corr_table_i <- corr_table[[i]]
corr_table_i <- as.data.frame(
as.table(corr_table_i)
)
names(corr_table_i) <- c("series", "reference", i)
corr_df <- corr_table_i
} else {
corr_table_i <- corr_table[[i]]
corr_table_i <- as.data.frame(
as.table(corr_table_i)
)
names(corr_table_i) <- c("series", "reference", i)
corr_df <- merge(corr_df, corr_table_i, by = c("series", "reference"))
}
}
corr_df <- corr_df[!duplicated(t(apply(corr_df[c("series", "reference")], 1, sort))), ]
for (i in names(corr_table)){
if (i == names(corr_table)[1]){
corr_table_i <- corr_table[[i]]
corr_table_i <- as.data.frame(
as.table(corr_table_i)
)
names(corr_table_i) <- c("series", "reference", i)
corr_df <- corr_table_i
} else {
corr_table_i <- corr_table[[i]]
corr_table_i <- as.data.frame(
as.table(corr_table_i)
)
names(corr_table_i) <- c("series", "reference", i)
corr_df <- merge(corr_df, corr_table_i, by = c("series", "reference"))
}
}
corr_df <- corr_df[!duplicated(t(apply(corr_df[c("series", "reference")], 1, sort))), ]
tmp <- merge(corr_df, descr)
View(tmp)
descr <- dplR::rwl.stats(x)[,1:4]
x = trs
y <- refs
descr <- dplR::rwl.stats(x)[,1:4]
colnames(descr) <- c("series", "first", "last", "length")
descr_ref <- dplR::rwl.stats(y)[,1:3]
colnames(descr_ref) <- c("reference", "ref_first", "ref_last")
tmp <- merge(corr_df, descr)
View(tmp)
tmp <- merge(tmp, descr_ref)
View(tmp)
col_order <- c(
"series",
"length",
"first",
"last",
"reference",
"ref_first",
"ref_last",
"overlap",
"glk",
"glk_p",
"r_pearson",
"t_St",
"t_BP",
"t_Ho"
)
tmp2 <- tmp[, col_order]
View(tmp2)
source("C:/Users/hanecakr/Documents/R_github/fellingdateR/R/corr_table.R")
source("C:/Users/hanecakr/Documents/R_github/fellingdateR/R/corr_table.R")
ct2 <- CorrTable(trs)
ct3 <- corr_table(trs)
ct2 <- CorrTable(trs)
ct3 <- corr_table(trs)
identical(ct2, ct3)
View(ct3)
source("C:/Users/hanecakr/Documents/R_github/fellingdateR/R/corr_table.R")
ct2 <- CorrTable(trs)
ct3 <- corr_table(trs)
View(ct3)
ct0m[['overlap']]
ct0m[['overlap']] -> tmp3
View(tmp3)
tmp3 <- as.data.frame(
as.table(ct0m[['overlap']])
)
View(tmp3)
source("C:/Users/hanecakr/Documents/R_github/fellingdateR/R/corr_table.R")
ct2 <- CorrTable(trs)
ct3 <- corr_table(trs)
ct0m <- CorrTable(x = trs, y = refs, output = "matrix")
ct1m <- corr_table(x = trs, y = refs, output = "matrix")
ct1m[["overlap"]] -> tmp3
View(tmp3)
source("C:/Users/hanecakr/Documents/R_github/fellingdateR/R/corr_table.R")
ct3 <- corr_table(trs)
View(ct3)
11*11
11*11 -11
View(tmp2)
ct1 <- corr_table(x = trs, y = refs)
source("C:/Users/hanecakr/Documents/R_github/fellingdateR/R/corr_table.R")
ct1 <- corr_table(x = trs, y = refs)
source("C:/Users/hanecakr/Documents/R_github/fellingdateR/R/corr_table.R")
ct0 <- CorrTable(x = trs, y = refs)
ct1 <- corr_table(x = trs, y = refs)
ct2 <- CorrTable(trs)
ct3 <- corr_table(trs)
View(ct3)
source("C:/Users/hanecakr/Documents/R_github/fellingdateR/R/corr_table.R")
ct1m -> corr_table
for (i in names(corr_table)){
if (i == names(corr_table)[1]){
corr_table_i <- corr_table[[i]]
corr_table_i <- as.data.frame(
as.table(corr_table_i),
stringsAsFactors = FALSE
)
names(corr_table_i) <- c("series", "reference", i)
corr_df <- corr_table_i
} else {
corr_table_i <- corr_table[[i]]
corr_table_i <- as.data.frame(
as.table(corr_table_i),
stringsAsFactors = FALSE
)
names(corr_table_i) <- c("series", "reference", i)
corr_df <- merge(corr_df, corr_table_i, by = c("series", "reference"))
}
}
corr_table <- merge(corr_df, descr)
corr_table <- merge(corr_table, descr_ref)
col_order <- c(
"series",
"length",
"first",
"last",
"reference",
"ref_first",
"ref_last",
"overlap",
"glk",
"glk_p",
"r_pearson",
"t_St",
"t_BP",
"t_Ho"
)
corr_table <- corr_table[, col_order]
corr_table <- subset(corr_table, series < reference)
sort_by <- "t_Ho"
sort_by <- c("series", sort_by)
corr_table <-
corr_table %>%
filter(overlap > 0) %>%
group_by(series) %>%
arrange(desc(across(all_of(sort_by))), .by_group = TRUE) %>%
ungroup()
return(corr_table)
View(corr_table)
debugSource("C:/Users/hanecakr/Documents/R_github/fellingdateR/R/corr_table.R")
corr_table <-
corr_table %>%
filter(overlap > 0) %>%
group_by(series) %>%
arrange(desc(across(all_of(sort_by))), .by_group = TRUE) %>%
ungroup()
ct1m -> corr_table
descr <- dplR::rwl.stats(x)[,1:4]
colnames(descr) <- c("series", "first", "last", "length")
descr_ref <- dplR::rwl.stats(y)[,1:3]
colnames(descr_ref) <- c("reference", "ref_first", "ref_last")
for (i in names(corr_table)){
if (i == names(corr_table)[1]){
corr_table_i <- corr_table[[i]]
corr_table_i <- as.data.frame(
as.table(corr_table_i),
stringsAsFactors = FALSE
)
names(corr_table_i) <- c("series", "reference", i)
corr_df <- corr_table_i
} else {
corr_table_i <- corr_table[[i]]
corr_table_i <- as.data.frame(
as.table(corr_table_i),
stringsAsFactors = FALSE
)
names(corr_table_i) <- c("series", "reference", i)
corr_df <- merge(corr_df, corr_table_i, by = c("series", "reference"))
}
}
corr_table <- merge(corr_df, descr)
corr_table <- merge(corr_table, descr_ref)
col_order <- c(
"series",
"length",
"first",
"last",
"reference",
"ref_first",
"ref_last",
"overlap",
"glk",
"glk_p",
"r_pearson",
"t_St",
"t_BP",
"t_Ho"
)
corr_table <- corr_table[, col_order]
corr_table <- subset(corr_table, series < reference)
View(corr_table)
with(corr_tabel, order(sort_by))
with(corr_table, order(sort_by))
sort_by
corr_table[with(corr_table, order(sort_by))]
corr_table[with(corr_table, order(series, t_Ho))]
corr_table[with(corr_table, order("series", "t_Ho"))]
corr_table[with(corr_table, order("series", "t_Ho")), ]
corr_table[with(corr_table, order(series, t_Ho)), ]
corr_table[with(corr_table, order(series, -t_Ho)), ]
source("C:/Users/hanecakr/Documents/R_github/fellingdateR/R/corr_table.R")
ct3 <- corr_table(trs)
source("C:/Users/hanecakr/Documents/R_github/fellingdateR/R/corr_table.R")
ct3 <- corr_table(trs)
source("C:/Users/hanecakr/Documents/R_github/fellingdateR/R/corr_table.R")
ct3 <- corr_table(trs)
source("C:/Users/hanecakr/Documents/R_github/fellingdateR/R/corr_table.R")
ct3 <- corr_table(trs)
source("C:/Users/hanecakr/Documents/R_github/fellingdateR/R/corr_table.R")
ct3 <- corr_table(trs)
ct1 <- corr_table(x = trs, y = refs)
source("C:/Users/hanecakr/Documents/R_github/fellingdateR/R/corr_table.R")
library(fellingdateR)
refs <- "C:/Users/hanecakr/Documents/R_statistics/Dendro/Refs.fh"
trs <- "C:/Users/hanecakr/Documents/R_statistics/Dendro/BRG.WOL29_1995.fh"
refs <- read_fh(refs)
trs <- read_fh(trs)
ct1 <- corr_table(x = trs, y = refs)
ct1m <- corr_table(x = trs, y = refs, output = "matrix")
ct3 <- corr_table(trs)
source("C:/Users/hanecakr/Documents/R_github/fellingdateR/R/corr_table.R")
ct3 <- corr_table(trs)
View(ct3)
(11*11)-11
ct3 <- corr_table(refs)
source("C:/Users/hanecakr/Documents/R_github/fellingdateR/R/corr_table.R")
source("C:/Users/hanecakr/Documents/R_github/fellingdateR/R/corr_table.R")
ct3 <- corr_table(trs)
?cor
source("C:/Users/hanecakr/Documents/R_github/fellingdateR/R/corr_table.R")
source("C:/Users/hanecakr/Documents/R_github/fellingdateR/R/corr_table.R")
source("C:/Users/hanecakr/Documents/R_github/fellingdateR/R/corr_table.R")
ct1m <- corr_table(x = trs, y = refs, output = "matrix")
ct3 <- corr_table(trs)
View(trs)
x = trs
y = refs
wuch_x <- apply(x, 2, function(x) {x / lag(x)})
View(wuch_x)
source("C:/Users/hanecakr/Documents/R_statistics/001_DendroFunctions/dendro_functions.R")
View(CorrTable)
### reduce x and y to common overlap, based on rownames = years
interval_x <- rownames(x)
interval_y <- rownames(y)
interval <- intersect(interval_x, interval_y)
x <- x[rownames(x) %in% interval, , drop = FALSE]
View(x)
y <- y[rownames(y) %in% interval, , drop = FALSE]
View(y)
wuch_x <- apply(x, 2, function(x) {x / lag(x)})
source("C:/Users/hanecakr/Documents/R_github/fellingdateR/R/corr_table.R")
# if (noRef == FALSE) {
wuch_y <- apply(y, 2, function(x) {x / lag(x)} )
View(wuch_y)
x <- x[rownames(x) %in% interval, , drop = FALSE]
y <- y[rownames(y) %in% interval, , drop = FALSE]
View(y)
y <- y[rownames(y) %in% interval, , drop = TRUE]
y <- y[rownames(y) %in% interval, , drop = TRUE]
View(y)
View(y)
x <- trs
y <- refs
### reduce x and y to common overlap, based on rownames = years
interval_x <- rownames(x)
interval_y <- rownames(y)
interval <- intersect(interval_x, interval_y)
# drop = FALSE ensures x/y remains a data.frame when only one series is present
xs <- x[rownames(x) %in% interval, , drop = FALSE]
ys <- y[rownames(y) %in% interval, , drop = FALSE]
sapply(xs, function(col) length(col))
sapply(xs, function(col) sum(is.na(col)))
View(xs)
sapply(xs, function(col) sum(!is.na(col)))
sapply(ys, function(col) sum(!is.na(col)))
sapply(ys, function(col) sum(!is.na(col))) > 2
ys[, sapply(ys, function(col) sum(!is.na(col))) > 3]
source("C:/Users/hanecakr/Documents/R_github/fellingdateR/R/corr_table.R")
ct3 <- corr_table(trs)
ct1 <- corr_table(x = trs, y = refs)
View(ct3)
source("C:/Users/hanecakr/Documents/R_github/fellingdateR/R/corr_table.R")
refs <- "C:/Users/hanecakr/Documents/R_statistics/Dendro/Refs.fh"
trs <- "C:/Users/hanecakr/Documents/R_statistics/Dendro/BRG.WOL29_1995.fh"
refs <- read_fh(refs)
trs <- read_fh(trs)
ct1 <- corr_table(x = trs, y = refs)
ct1m <- corr_table(x = trs, y = refs, output = "matrix")
ct3 <- corr_table(trs)
View(ct1)
View(ct3)
source("C:/Users/hanecakr/Documents/R_github/fellingdateR/R/corr_table.R")
ct3 <- corr_table(trs)
View(ct3)
View(x)
source("C:/Users/hanecakr/Documents/R_github/fellingdateR/R/corr_table.R")
ct3 <- corr_table(trs)
source("C:/Users/hanecakr/Documents/R_github/fellingdateR/R/corr_table.R")
source("C:/Users/hanecakr/Documents/R_github/fellingdateR/R/corr_table.R")
ct1 <- corr_table(x = trs, y = refs, remove.duplicates = FALSE)
ct1 <- corr_table(x = trs, y = refs, sort_by = "niets")
ct1 <- corr_table(x = trs, y = refs, sort_by = "glk")
View(ct1)
View(ct1)
ct1 <- corr_table(x = trs, y = refs, sort_by = "t_Ho")
View(ct1)
View(ct1)
source("C:/Users/hanecakr/Documents/R_github/fellingdateR/R/corr_table.R")
ct1 <- corr_table(x = trs, y = refs, sort_by = "t_Ho")
?lag
lag(1:5)
lag(1:5, 2)
source("C:/Users/hanecakr/Documents/R_github/fellingdateR/R/corr_table.R")
ct1 <- corr_table(x = trs, y = refs, sort_by = "t_Ho")
source("C:/Users/hanecakr/Documents/R_github/fellingdateR/R/corr_table.R")
ct1 <- corr_table(x = trs, y = refs, sort_by = "t_Ho")
ct3 <- corr_table(trs)
source("C:/Users/hanecakr/Documents/R_github/fellingdateR/R/corr_table.R")
source("C:/Users/hanecakr/Documents/R_github/fellingdateR/R/corr_table.R")
ct3 <- corr_table(trs)
ct1 <- corr_table(x = trs, y = refs, sort_by = "t_Ho")
,LOG
?log
source("C:/Users/hanecakr/Documents/R_github/fellingdateR/R/corr_table.R")
ct1 <- corr_table(x = trs, y = refs, sort_by = "t_Ho")
debugSource("C:/Users/hanecakr/Documents/R_github/fellingdateR/R/corr_table.R")
ct1 <- corr_table(x = trs, y = refs, sort_by = "t_Ho")
ct3 <- corr_table(trs)
ct1m <- corr_table(x = trs, y = refs, output = "matrix")
ct1 <- corr_table(x = trs, y = refs, sort_by = "t_Ho")
source("C:/Users/hanecakr/Documents/R_github/fellingdateR/R/corr_table.R")
ct1 <- corr_table(x = trs, y = refs, sort_by = "t_Ho")
ct3 <- corr_table(trs)
source("C:/Users/hanecakr/Documents/R_github/fellingdateR/R/corr_table.R")
ct1 <- corr_table(x = trs, y = refs, sort_by = "t_Ho")
ct3 <- corr_table(trs)
source("C:/Users/hanecakr/Documents/R_github/fellingdateR/R/corr_table.R")
ct1 <- corr_table(x = trs, y = refs, sort_by = "t_Ho")
source("C:/Users/hanecakr/Documents/R_github/fellingdateR/R/corr_table.R")
?dplR::glk
source("C:/Users/hanecakr/Documents/R_github/fellingdateR/R/cor_table.R")
source("C:/Users/hanecakr/Documents/R_github/fellingdateR/R/cor_table.R")
library(devtools)
load_all
load_all()
load_all()
load_all()
check()
document()
install()
?cor_table
check()
check()
check()
person("Kristof", "Haneca", , "Kristof.Haneca@vlaanderen.be",
role = c("aut", "cre"),
comment = c(ORCID = "0000-0002-7719-8305"))
c(person("Kristof", "Haneca", , "Kristof.Haneca@vlaanderen.be",
role = c("aut", "cre"),
comment = c(ORCID = "0000-0002-7719-8305")),
person("Koen", "Van Daele", role = "ctb",
comment = c(ORCID = "0000-0002-8153-2978"))
)
check()
check()
load_all()
library(devtools)
load_all()
check()
load_all()
check()
load_all()
check()
usethis::use_package_doc()
devtools::document()
