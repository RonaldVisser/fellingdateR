source("C:/Users/hanecakr/Documents/R_github/fellingdateR/R/sw_sum_plot.r")
load_all()
sw_sum(dummy1, plot = T
sw_sum(dummy1, plot = T)
sw_sum(dummy2, plot = T)
sw_sum(dummy3, plot = T)
sw_sum(dummy3, plot = F)
source("C:/Users/hanecakr/Documents/R_github/fellingdateR/R/sw_sum.R")
load_all()
source("C:/Users/hanecakr/Documents/R_github/fellingdateR/R/sw_sum_plot.r")
sw_sum(dummy1, plot = T)
sw_sum(dummy3, plot = F)
sw_sum(dummy3, plot = T)
source("C:/Users/hanecakr/Documents/R_github/fellingdateR/R/sw_sum.R")
load_all()
sw_sum(dummy3, plot = T)
sw_sum(dummy4, plot = T)
sw_sum(dummy5, plot = T)
View(dummy4)
sw_sum(dummy5, plot = F)
sw_sum(dummy4, plot = F)
sw_sum(dummy4, plot = T)
source("C:/Users/hanecakr/Documents/R_github/fellingdateR/R/sw_sum_plot.r")
load_all()
sw_sum(dummy4, plot = T)
sw_sum(dummy4, plot = F) -> test
test -> pdf_matrix
# pdf_matrix <- subset(pdf_matrix, SPD > 0.0001 & !is.na(SPD)) & !is.na(SPD_wk))
smooth <-
as.data.frame(
movAv(pdf_matrix$SPD, 11, align = "center", edges = "fill")
)
names(smooth) <- "SPD_movAv"
pdf_matrix <- cbind(pdf_matrix, smooth)
spline_int <-
as.data.frame(
spline(pdf_matrix$year, pdf_matrix$SPD_movAv, method = "natural")
)
plot_range <- range(pdf_matrix$year)
p_max <- max(pdf_matrix$SPD)
fd <- pdf_matrix[, c("year", "SPD_wk")]
View(fd)
fd <- subset(fd, !is.na(SPD_wk))
View(fd)
fd <- pdf_matrix[, c("year", "SPD_wk")]
fd <- subset(fd, SPD_wk>0)
if (nrow(fd) > 0){
fd <- rep(fd$year, fd$SPD_wk)
fd <- data.frame(fd)
names(fd) <- "year"
fd$y <- 1
fd <- fd |>
dplyr::group_by(year) |>
dplyr::mutate(y = cumsum(y)) |>
dplyr::left_join(pdf_matrix |>
dplyr::select("year", "SPD"), by = "year")
} else {
fd <- NULL
}
p <-
pdf_matrix |>
dplyr::select(year, SPD, SPD_movAv) |>
ggplot2::ggplot() +
ggplot2::geom_col(ggplot2::aes(x = year, y = SPD),
fill = bar_col,
alpha = 0.5) +
ggplot2::geom_line(data = spline_int,
ggplot2::aes(x = x, y = y),
color = spline_col,
size = 1,
alpha = .5) +
ggplot2::geom_point(data = fd,
ggplot2::aes(x = year, y = SPD + y * p_max/20),
size = 3,
shape = 8,
colour = "navyblue") +
ggplot2::scale_x_continuous(
limits = c(plyr::round_any(plot_range[1], 10, floor),
plyr::round_any(plot_range[2], 10, ceiling)),
breaks = seq(plyr::round_any(plot_range[1], 10, floor),
plyr::round_any(plot_range[2], 10, ceiling),
20)) +
ggplot2::theme_minimal()  +
ggplot2::xlab("calendar year") +
ggplot2::theme(
axis.text=ggplot2::element_text(size=10),
# axis.title.x=ggplot2::element_blank(),
# axis.title.y=ggplot2::element_blank(),
# axis.text.y = element_blank(),
panel.grid.minor.y=ggplot2::element_blank(),
panel.grid.major.y=ggplot2::element_blank(),
legend.position = "none"
)
bar_col = "lightblue", spline_col = "tomato3"
bar_col = "lightblue"
spline_col = "tomato3"
p <-
pdf_matrix |>
dplyr::select(year, SPD, SPD_movAv) |>
ggplot2::ggplot() +
ggplot2::geom_col(ggplot2::aes(x = year, y = SPD),
fill = bar_col,
alpha = 0.5) +
ggplot2::geom_line(data = spline_int,
ggplot2::aes(x = x, y = y),
color = spline_col,
size = 1,
alpha = .5) +
ggplot2::geom_point(data = fd,
ggplot2::aes(x = year, y = SPD + y * p_max/20),
size = 3,
shape = 8,
colour = "navyblue") +
ggplot2::scale_x_continuous(
limits = c(plyr::round_any(plot_range[1], 10, floor),
plyr::round_any(plot_range[2], 10, ceiling)),
breaks = seq(plyr::round_any(plot_range[1], 10, floor),
plyr::round_any(plot_range[2], 10, ceiling),
20)) +
ggplot2::theme_minimal()  +
ggplot2::xlab("calendar year") +
ggplot2::theme(
axis.text=ggplot2::element_text(size=10),
# axis.title.x=ggplot2::element_blank(),
# axis.title.y=ggplot2::element_blank(),
# axis.text.y = element_blank(),
panel.grid.minor.y=ggplot2::element_blank(),
panel.grid.major.y=ggplot2::element_blank(),
legend.position = "none"
)
return(p)
p
fd <- pdf_matrix[, c("year", "SPD_wk")]
fd <- subset(fd, SPD_wk>0)
if (nrow(fd) > 0){
fd <- rep(fd$year, fd$SPD_wk)
fd <- data.frame(fd)
names(fd) <- "year"
fd$y <- 1
fd <- fd |>
dplyr::group_by(year) |>
dplyr::mutate(y = cumsum(y)) |>
dplyr::left_join(pdf_matrix |>
dplyr::select("year", "SPD"), by = "year")
}
p <-
pdf_matrix |>
dplyr::select(year, SPD, SPD_movAv) |>
ggplot2::ggplot() +
ggplot2::geom_col(ggplot2::aes(x = year, y = SPD),
fill = bar_col,
alpha = 0.5) +
ggplot2::geom_line(data = spline_int,
ggplot2::aes(x = x, y = y),
color = spline_col,
size = 1,
alpha = .5) +
ggplot2::geom_point(data = fd,
ggplot2::aes(x = year, y = SPD + y * p_max/20),
size = 3,
shape = 8,
colour = "navyblue") +
ggplot2::scale_x_continuous(
limits = c(plyr::round_any(plot_range[1], 10, floor),
plyr::round_any(plot_range[2], 10, ceiling)),
breaks = seq(plyr::round_any(plot_range[1], 10, floor),
plyr::round_any(plot_range[2], 10, ceiling),
20)) +
ggplot2::theme_minimal()  +
ggplot2::xlab("calendar year") +
ggplot2::theme(
axis.text=ggplot2::element_text(size=10),
# axis.title.x=ggplot2::element_blank(),
# axis.title.y=ggplot2::element_blank(),
# axis.text.y = element_blank(),
panel.grid.minor.y=ggplot2::element_blank(),
panel.grid.major.y=ggplot2::element_blank(),
legend.position = "none"
)
p
View(fd)
fd <- pdf_matrix[, c("year", "SPD_wk")]
fd <- subset(fd, SPD_wk>0)
p <-
pdf_matrix |>
dplyr::select(year, SPD, SPD_movAv) |>
ggplot2::ggplot() +
ggplot2::geom_col(ggplot2::aes(x = year, y = SPD),
fill = bar_col,
alpha = 0.5) +
ggplot2::geom_line(data = spline_int,
ggplot2::aes(x = x, y = y),
color = spline_col,
size = 1,
alpha = .5) +
ggplot2::geom_point(data = fd,
ggplot2::aes(x = year, y = SPD + y * p_max/20),
size = 3,
shape = 8,
colour = "navyblue") +
ggplot2::scale_x_continuous(
limits = c(plyr::round_any(plot_range[1], 10, floor),
plyr::round_any(plot_range[2], 10, ceiling)),
breaks = seq(plyr::round_any(plot_range[1], 10, floor),
plyr::round_any(plot_range[2], 10, ceiling),
20)) +
ggplot2::theme_minimal()  +
ggplot2::xlab("calendar year") +
ggplot2::theme(
axis.text=ggplot2::element_text(size=10),
# axis.title.x=ggplot2::element_blank(),
# axis.title.y=ggplot2::element_blank(),
# axis.text.y = element_blank(),
panel.grid.minor.y=ggplot2::element_blank(),
panel.grid.major.y=ggplot2::element_blank(),
legend.position = "none"
)
p
p <-
pdf_matrix |>
dplyr::select(year, SPD, SPD_movAv) |>
ggplot2::ggplot() +
ggplot2::geom_col(ggplot2::aes(x = year, y = SPD),
fill = bar_col,
alpha = 0.5) +
ggplot2::geom_line(data = spline_int,
ggplot2::aes(x = x, y = y),
color = spline_col,
size = 1,
alpha = .5) +
ggplot2::geom_point(data = fd,
ggplot2::aes(x = year, y = SPD + y * p_max/20),
size = 3,
shape = 8,
colour = "navyblue") +
ggplot2::scale_x_continuous(
limits = c(plyr::round_any(plot_range[1], 10, floor),
plyr::round_any(plot_range[2], 10, ceiling)),
breaks = seq(plyr::round_any(plot_range[1], 10, floor),
plyr::round_any(plot_range[2], 10, ceiling),
20)) +
ggplot2::theme_minimal()  +
ggplot2::xlab("calendar year") +
ggplot2::theme(
axis.text=ggplot2::element_text(size=10),
# axis.title.x=ggplot2::element_blank(),
# axis.title.y=ggplot2::element_blank(),
# axis.text.y = element_blank(),
panel.grid.minor.y=ggplot2::element_blank(),
panel.grid.major.y=ggplot2::element_blank(),
legend.position = "none"
)
nrow(fd) > 0
source("C:/Users/hanecakr/Documents/R_github/fellingdateR/R/sw_sum_plot.r")
fd <- pdf_matrix[, c("year", "SPD_wk")]
fd <- subset(fd, SPD_wk>0)
if (nrow(fd) > 0){
fd <- rep(fd$year, fd$SPD_wk)
fd <- data.frame(fd)
names(fd) <- "year"
fd$y <- 1
fd <- fd |>
dplyr::group_by(year) |>
dplyr::mutate(y = cumsum(y)) |>
dplyr::left_join(pdf_matrix |>
dplyr::select("year", "SPD"), by = "year")
} else {
fd <- data.frame(year = NULL, y = 0)
}
p <-
pdf_matrix |>
dplyr::select(year, SPD, SPD_movAv) |>
ggplot2::ggplot() +
ggplot2::geom_col(ggplot2::aes(x = year, y = SPD),
fill = bar_col,
alpha = 0.5) +
ggplot2::geom_line(data = spline_int,
ggplot2::aes(x = x, y = y),
color = spline_col,
size = 1,
alpha = .5) +
ggplot2::geom_point(data = fd,
ggplot2::aes(x = year, y = SPD + y * p_max/20),
size = 3,
shape = 8,
colour = "navyblue") +
ggplot2::scale_x_continuous(
limits = c(plyr::round_any(plot_range[1], 10, floor),
plyr::round_any(plot_range[2], 10, ceiling)),
breaks = seq(plyr::round_any(plot_range[1], 10, floor),
plyr::round_any(plot_range[2], 10, ceiling),
20)) +
ggplot2::theme_minimal()  +
ggplot2::xlab("calendar year") +
ggplot2::theme(
axis.text=ggplot2::element_text(size=10),
# axis.title.x=ggplot2::element_blank(),
# axis.title.y=ggplot2::element_blank(),
# axis.text.y = element_blank(),
panel.grid.minor.y=ggplot2::element_blank(),
panel.grid.major.y=ggplot2::element_blank(),
legend.position = "none"
)
return(p)
fd <- pdf_matrix[, c("year", "SPD_wk")]
fd <- subset(fd, SPD_wk>0)
if (nrow(fd) > 0){
fd <- rep(fd$year, fd$SPD_wk)
fd <- data.frame(fd)
names(fd) <- "year"
fd$y <- 1
fd <- fd |>
dplyr::group_by(year) |>
dplyr::mutate(y = cumsum(y)) |>
dplyr::left_join(pdf_matrix |>
dplyr::select("year", "SPD"), by = "year")
} else {
fd <- data.frame(year = NA, y = 0)
}
p <-
pdf_matrix |>
dplyr::select(year, SPD, SPD_movAv) |>
ggplot2::ggplot() +
ggplot2::geom_col(ggplot2::aes(x = year, y = SPD),
fill = bar_col,
alpha = 0.5) +
ggplot2::geom_line(data = spline_int,
ggplot2::aes(x = x, y = y),
color = spline_col,
size = 1,
alpha = .5) +
ggplot2::geom_point(data = fd,
ggplot2::aes(x = year, y = SPD + y * p_max/20),
size = 3,
shape = 8,
colour = "navyblue") +
ggplot2::scale_x_continuous(
limits = c(plyr::round_any(plot_range[1], 10, floor),
plyr::round_any(plot_range[2], 10, ceiling)),
breaks = seq(plyr::round_any(plot_range[1], 10, floor),
plyr::round_any(plot_range[2], 10, ceiling),
20)) +
ggplot2::theme_minimal()  +
ggplot2::xlab("calendar year") +
ggplot2::theme(
axis.text=ggplot2::element_text(size=10),
# axis.title.x=ggplot2::element_blank(),
# axis.title.y=ggplot2::element_blank(),
# axis.text.y = element_blank(),
panel.grid.minor.y=ggplot2::element_blank(),
panel.grid.major.y=ggplot2::element_blank(),
legend.position = "none"
)
p
fd <- pdf_matrix[, c("year", "SPD_wk")]
fd <- subset(fd, SPD_wk>0)
if (nrow(fd) > 0){
fd <- rep(fd$year, fd$SPD_wk)
fd <- data.frame(fd)
names(fd) <- "year"
fd$y <- 1
fd <- fd |>
dplyr::group_by(year) |>
dplyr::mutate(y = cumsum(y)) |>
dplyr::left_join(pdf_matrix |> dplyr::select("year", "SPD"), by = "year")
} else {
fd <- data.frame(year = NA, SPD = NA)
}
p <-
pdf_matrix |>
dplyr::select(year, SPD, SPD_movAv) |>
ggplot2::ggplot() +
ggplot2::geom_col(ggplot2::aes(x = year, y = SPD),
fill = bar_col,
alpha = 0.5) +
ggplot2::geom_line(data = spline_int,
ggplot2::aes(x = x, y = y),
color = spline_col,
size = 1,
alpha = .5) +
ggplot2::geom_point(data = fd,
ggplot2::aes(x = year, y = SPD + y * p_max/20),
size = 3,
shape = 8,
colour = "navyblue") +
ggplot2::scale_x_continuous(
limits = c(plyr::round_any(plot_range[1], 10, floor),
plyr::round_any(plot_range[2], 10, ceiling)),
breaks = seq(plyr::round_any(plot_range[1], 10, floor),
plyr::round_any(plot_range[2], 10, ceiling),
20)) +
ggplot2::theme_minimal()  +
ggplot2::xlab("calendar year") +
ggplot2::theme(
axis.text=ggplot2::element_text(size=10),
# axis.title.x=ggplot2::element_blank(),
# axis.title.y=ggplot2::element_blank(),
# axis.text.y = element_blank(),
panel.grid.minor.y=ggplot2::element_blank(),
panel.grid.major.y=ggplot2::element_blank(),
legend.position = "none"
)
p
fd <- pdf_matrix[, c("year", "SPD_wk")]
fd <- subset(fd, SPD_wk>0)
if (nrow(fd) > 0){
fd <- rep(fd$year, fd$SPD_wk)
fd <- data.frame(fd)
names(fd) <- "year"
fd$y <- 1
fd <- fd |>
dplyr::group_by(year) |>
dplyr::mutate(SPW_wk = cumsum(y)) |>
dplyr::left_join(pdf_matrix |> dplyr::select("year", "SPD"), by = "year")
} else {
fd <- data.frame(year = NA, SPD = NA)
}
fd <- subset(fd, SPD_wk>0)
if (nrow(fd) > 0){
fd <- rep(fd$year, fd$SPD_wk)
fd <- data.frame(fd)
names(fd) <- "year"
fd$y <- 1
fd <- fd |>
dplyr::group_by(year) |>
dplyr::mutate(SPW_wk = cumsum(y)) |>
dplyr::left_join(pdf_matrix |> dplyr::select("year", "SPD"), by = "year")
} else {
fd <- data.frame(year = NA, SPW = NA, SPD_wk = NA)
}
fd <- pdf_matrix[, c("year", "SPD_wk")]
fd <- subset(fd, SPD_wk>0)
if (nrow(fd) > 0){
fd <- rep(fd$year, fd$SPD_wk)
fd <- data.frame(fd)
names(fd) <- "year"
fd$y <- 1
fd <- fd |>
dplyr::group_by(year) |>
dplyr::mutate(y = cumsum(y)) |>
dplyr::left_join(pdf_matrix |> dplyr::select("year", "SPD"), by = "year")
} else {
fd <- data.frame(year = NA, SPD = NA, y = NA)
}
p <-
pdf_matrix |>
dplyr::select(year, SPD, SPD_movAv) |>
ggplot2::ggplot() +
ggplot2::geom_col(ggplot2::aes(x = year, y = SPD),
fill = bar_col,
alpha = 0.5) +
ggplot2::geom_line(data = spline_int,
ggplot2::aes(x = x, y = y),
color = spline_col,
size = 1,
alpha = .5) +
ggplot2::geom_point(data = fd,
ggplot2::aes(x = year, y = SPD + y * p_max/20),
size = 3,
shape = 8,
colour = "navyblue") +
ggplot2::scale_x_continuous(
limits = c(plyr::round_any(plot_range[1], 10, floor),
plyr::round_any(plot_range[2], 10, ceiling)),
breaks = seq(plyr::round_any(plot_range[1], 10, floor),
plyr::round_any(plot_range[2], 10, ceiling),
20)) +
ggplot2::theme_minimal()  +
ggplot2::xlab("calendar year") +
ggplot2::theme(
axis.text=ggplot2::element_text(size=10),
# axis.title.x=ggplot2::element_blank(),
# axis.title.y=ggplot2::element_blank(),
# axis.text.y = element_blank(),
panel.grid.minor.y=ggplot2::element_blank(),
panel.grid.major.y=ggplot2::element_blank(),
legend.position = "none"
)
p
source("C:/Users/hanecakr/Documents/R_github/fellingdateR/R/sw_sum_plot.r")
load_all()
sw_sum(dummy4, plot = T)
sw_sum(dummy1, plot = T)
sw_sum(dummy2, plot = T)
sw_sum(dummy3, plot = T)
sw_sum(dummy5, plot = T)
sw_sum(dummy6, plot = T)
View(dummy4)
source("C:/Users/hanecakr/Documents/R_github/fellingdateR/R/sw_sum_plot.r")
load_all()
sw_sum(dummy6, plot = T)
View(dummy4)
sw_sum(dummy4, plot = T)
source("C:/Users/hanecakr/Documents/R_github/fellingdateR/R/sw_sum.R")
load_all()
sw_sum(dummy1, plot = T)
sw_sum(dummy2, plot = T)
sw_sum(dummy23 plot = T)
sw_sum(dummy3 plot = T)
sw_sum(dummy3, plot = T)
sw_sum(dummy4, plot = T)
sw_sum(dummy6, plot = T)
View(dummy6)
View(test_data)
sw_sum(dummy7, plot = T)
sw_sum(test_data, plot = T)
load_all()
load_all()
document()
check()
source("C:/Users/hanecakr/Documents/R_github/fellingdateR/R/sw_sum_plot.r")
source("C:/Users/hanecakr/Documents/R_github/fellingdateR/R/sw_sum.R")
